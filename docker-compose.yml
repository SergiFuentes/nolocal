version: "3.3"

services:
  caddy:
    image: davidtca/caddy-discord:latest
    container_name: caddy
    restart: unless-stopped
    ports:
      - "443:443"
    volumes:
      - ./Caddyfile:/etc/caddy/Caddyfile
  nolocal:
    image: davidtca/nolocal
    container_name: nolocal
    environment:
      - DISCORD_TOKEN
      - INSIGHTS_KEY
  newrelic-infra:
    image: 'newrelic/infrastructure:latest'
    container_name: newrelic-infra
    cap_add: SYS_PTRACE
    network_mode: host
    privileged: true
    pid: host
    volumes:
      - '/:/host:ro'
      - '/var/run/docker.sock:/var/run/docker.sock'
    environment:
      - NRIA_LICENSE_KEY